# Laravel 8.x — Тестирование: начало работы

- [Введение](#introduction)
- [Окружение](#environment)
- [Создание и запуск тестов](#creating-and-running-tests)
    - [Запуск с помощью Artisan](#artisan-test-runner)

<a name="introduction"></a>
## Введение

Laravel построен с учетом требований тестирования. Фактически, поддержка тестирования с помощью PHPUnit включена прямо из коробки, и файл `phpunit.xml` уже настроен для вашего приложения. Фреймворк также поставляется с удобными вспомогательными методами, позволяющими выразительно тестировать ваши приложения.

По умолчанию каталог `tests` вашего приложения содержит два каталога: `Feature` и `Unit`. Модульные тесты - это тесты, которые фокусируются на очень небольшой изолированной части вашего кода. Фактически, большинство модульных тестов, вероятно, сосредоточены на одном методе. Тесты в каталоге «Unit» тестов не загружают ваше приложение Laravel и, следовательно, не могут получить доступ к базе данных вашего приложения или другим службам фреймворка.

Функциональные тесты могут тестировать большую часть вашего кода, включая взаимодействие нескольких объектов друг с другом, или даже целый HTTP-запрос, возвращающий JSON. **Как правило, большинство ваших тестов должны быть функциональными. Эти типы тестов обеспечивают максимальную уверенность в том, что ваша система в целом работает должным образом.**

Файл ExampleTest.php находится в каталогах тестов `Feature` и `Unit`. После установки нового приложения Laravel выполните команды `vendor/bin/phpunit` или `php artisan test` из командной строки для запуска ваших тестов.

<a name="environment"></a>
## Окружение

При запуске тестов через `vendor/bin/phpunit` Laravel автоматически устанавливает [конфигурацию окружения](configuration.md#environment-configuration) как «тестовое» благодаря переменной окружения, определенной в файле `phpunit.xml`. Laravel во время тестирования также автоматически настраивает для сессии и кеша драйверы `array`, что означает, что во время тестирования данные сессии или кеша не сохраняются.

При необходимости вы можете определять другие значения конфигурации среды тестирования. Переменные окружения `testing` могут быть настроены в файле `phpunit.xml`, но перед запуском тестов не забудьте очистить кеш конфигурации с помощью Artisan-команды `config:clear`!

<a name="the-env-testing-environment-file"></a>
#### Переменная окружения `.env.testing`

Кроме того, вы можете создать файл `.env.testing` в корне вашего проекта. Этот файл будет использоваться вместо `.env` при запуске тестов PHPUnit или выполнении команд Artisan с параметром `--env=testing`.

<a name="creating-and-running-tests"></a>
## Создание и запуск тестов

Чтобы создать новый тест, используйте команду artisan `make:test`. По умолчанию тесты будут помещены в каталог `tests/Feature`:

    php artisan make:test UserTest

Если вы хотите создать тест в каталоге `tests/Unit`, вы можете использовать параметр `--unit` при выполнении команды `make:test`:

    php artisan make:test UserTest --unit

> {tip} Тестовые заглушки можно настроить с помощью [публикации заглушек](artisan.md#stub-customization).

После того, как тест был сгенерирован, вы можете определить методы тестирования, как обычно, используя [PHPUnit](https://phpunit.de). Чтобы запустить ваши тесты, выполните команду `vendor/bin/phpunit` или `php artisan test` из вашего терминала:

    <?php

    namespace Tests\Unit;

    use PHPUnit\Framework\TestCase;

    class ExampleTest extends TestCase
    {
        /**
         * Базовый пример теста.
         *
         * @return void
         */
        public function testBasicTest()
        {
            $this->assertTrue(true);
        }
    }

> {note} Если вы определяете свои собственные методы `setUp` / `tearDown` в тестовом классе, обязательно вызывайте соответствующие методы `parent::setUp()` / `parent::tearDown()` родительского класса.

<a name="artisan-test-runner"></a>
### Запуск с помощью Artisan

В дополнение к команде `phpunit`, вы можете использовать команду `test` Artisan для запуска ваших тестов. Тестер Artisan предоставляет подробные отчеты о тестах, чтобы упростить разработку и отладку:

    php artisan test

Любые аргументы, которые могут быть переданы команде `phpunit`, также могут быть переданы команде Artisan `test`:

    php artisan test --testsuite=Feature --stop-on-failure
